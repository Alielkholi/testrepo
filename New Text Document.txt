CREATE OR REPLACE FUNCTION GET_BETEWEEN_DATE(V_FROM_DATE VARCHAR2(20), V_TO_DATE VARCHAR2(20)) 
RETURN VARCHAR2
IS

V_MONTH NUMBER(2);
V_DAY NUMBER (10);
BEGIN 


SELECT MONTHS_BETWEEN (TO_DATE(V_FROM_DATE,'DD-MM-YYYY'),TO_DATE(V_TO_DATE,'DD-MM-YYYY') ), FLOOR(TO_DATE(V_FROM_DATE,'DD-MM-YYYY')-TO_DATE(V_TO_DATE,'DD-MM-YYYY'))
INTO V_MONTH , V_DAY
FROM DUAL;

RETURN('MNTHS: '|| V_MONTH || ' DAYS : ' || V_DAY);
END;
-------------------------------------------------
SELECT DEPARTMENT_NAME , DEPARTMENT_ID,(SELECT COUNT(E.EMPLOYEE_ID)  FROM EMPLOYEES E WHERE E.DEPARTMENT_ID = D.DEPARTMENT_ID
AND TO_NUMBER(TO_CHAR(E.HIRE_DATE,'MM'))= 01 )JAN ,(SELECT COUNT(E.EMPLOYEE_ID) JAN FROM EMPLOYEES E WHERE E.DEPARTMENT_ID = D.DEPARTMENT_ID
AND TO_NUMBER(TO_CHAR(E.HIRE_DATE,'MM'))= 02 )FEB ,(SELECT COUNT(E.EMPLOYEE_ID) JAN FROM EMPLOYEES E WHERE E.DEPARTMENT_ID = D.DEPARTMENT_ID
AND TO_NUMBER(TO_CHAR(E.HIRE_DATE,'MM'))= 03 ) MAR ,(SELECT COUNT(E.EMPLOYEE_ID) JAN FROM EMPLOYEES E WHERE E.DEPARTMENT_ID = D.DEPARTMENT_ID
AND TO_NUMBER(TO_CHAR(E.HIRE_DATE,'MM'))= 04 ) APR, (SELECT COUNT(E.EMPLOYEE_ID) JAN FROM EMPLOYEES E WHERE E.DEPARTMENT_ID = D.DEPARTMENT_ID
AND TO_NUMBER(TO_CHAR(E.HIRE_DATE,'MM'))= 05 ) MAY, (SELECT COUNT(E.EMPLOYEE_ID) JAN FROM EMPLOYEES E WHERE E.DEPARTMENT_ID = D.DEPARTMENT_ID
AND TO_NUMBER(TO_CHAR(E.HIRE_DATE,'MM'))= 06 )JUN, (SELECT COUNT(E.EMPLOYEE_ID) JAN FROM EMPLOYEES E WHERE E.DEPARTMENT_ID = D.DEPARTMENT_ID
AND TO_NUMBER(TO_CHAR(E.HIRE_DATE,'MM'))= 07 )JUL ,(SELECT COUNT(E.EMPLOYEE_ID) JAN FROM EMPLOYEES E WHERE E.DEPARTMENT_ID = D.DEPARTMENT_ID
AND TO_NUMBER(TO_CHAR(E.HIRE_DATE,'MM'))= 08 ) AUG, (SELECT COUNT(E.EMPLOYEE_ID) JAN FROM EMPLOYEES E WHERE E.DEPARTMENT_ID = D.DEPARTMENT_ID
AND TO_NUMBER(TO_CHAR(E.HIRE_DATE,'MM'))= 09 ) SEP,(SELECT COUNT(E.EMPLOYEE_ID) JAN FROM EMPLOYEES E WHERE E.DEPARTMENT_ID = D.DEPARTMENT_ID
AND TO_NUMBER(TO_CHAR(E.HIRE_DATE,'MM'))= 10 )OCT,(SELECT COUNT(E.EMPLOYEE_ID) JAN FROM EMPLOYEES E WHERE E.DEPARTMENT_ID = D.DEPARTMENT_ID
AND TO_NUMBER(TO_CHAR(E.HIRE_DATE,'MM'))= 11 ) NOV,(SELECT COUNT(E.EMPLOYEE_ID) JAN FROM EMPLOYEES E WHERE E.DEPARTMENT_ID = D.DEPARTMENT_ID
AND TO_NUMBER(TO_CHAR(E.HIRE_DATE,'MM'))= 12 ) DECMP

FROM DEPARTMENTS D

GROUP BY D.DEPARTMENT_NAME ,D.DEPARTMENT_ID